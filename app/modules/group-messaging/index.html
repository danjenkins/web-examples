<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimal-ui">
    <title>Group Messaging</title>
    <link rel="stylesheet" href="/css/group-messaging.css">
    <link rel="stylesheet" href="/css/fontello.css">
</head>
<body>

    <script type="text/x-handlebars-template" id="chat-tabs-template">
        {{#each tabs}}
        <a href="#" id="{{label}}" class="tab{{#if isActive}} active{{/if}}">
            <i class="icon-cancel-squared close"></i>{{label}}
        </a>
        {{/each}}
    </script>

    <script type="text/x-handlebars-template" id="buddies-template">
        {{#each buddies}}
        <li id="{{username}}" class="buddy-list--mini__user{{#if isActive}} active{{/if}}">
            <img src="{{#gravatar}}{{username}}{{/gravatar}}" alt="{{username}}" class="buddy-list--mini__user__avatar">
            <div class="buddy-list__user__name">{{username}}</div>
            <div class="presence">
                <div class="buddy-list__user__status--{{#presenceClass}}{{presence}}{{/presenceClass}}">{{presence}}</div>
            </div>
        </li>
        {{/each}}
    </script>

    <script type="text/x-handlebars-template" id="chat-list-item">
        <li class="message--full-{{#if isMyMessage}}left{{else}}right{{/if}}">
            <img class="message--full-{{#if isMyMessage}}left{{else}}right{{/if}}__avatar" src="{{photo}}" alt="{{fullName}}">
            <div class="message--full-{{#if isMyMessage}}left{{else}}right{{/if}}__container">
                <div class="message--full-{{#if isMyMessage}}left{{else}}right{{/if}}__container__content">
                    {{message}}
                </div>
                <div class="message--full-{{#if isMyMessage}}left{{else}}right{{/if}}__meta">
                    {{fullName}} at <time>{{time}}</time>
                </div>
            </div>
        </li>
    </script>

    <header class="group-chat__header">
        <button class="group-list-open">View Buddies</button>
        <div class="group-chat__header__me">
            <a href="#">Log out</a> as John
        </div>
        <nav class="group-chat__header__tabs">
            <!--<a href="#" id="tab-12345" class="tab active">Everyone</a>-->
        </nav>
    </header>

    <div class="chat-window">
        <nav class="group-list">
            <ul class="buddy-list--mini">
                <!--<li class="buddy-list--mini__user active">-->
                    <!--<div class="buddy-list--mini__user__name">Everyone</div>-->
                <!--</li>-->
                <!--<li class="buddy-list--mini__user">-->
                    <!--<div class="buddy-list--mini__user__name">Alice</div>-->
                <!--</li>-->
                <!--<li class="buddy-list--mini__user">-->
                    <!--<div class="buddy-list--mini__user__name">Bob</div>-->
                <!--</li>-->
                <!--<li class="buddy-list--mini__user">-->
                    <!--<div class="buddy-list--mini__user__name">John</div>-->
                <!--</li>-->
                <!--<li class="buddy-list--mini__user">-->
                    <!--<div class="buddy-list--mini__user__name">Steven</div>-->
                <!--</li>-->
            </ul>
        </nav>

        <form class="group-chat__form">
            <input type="text" class="group-chat__form__text" placeholder="Enter your message here">
            <input type="submit" value="Send" class="group-chat__form__submit">
        </form>

        <section class="group-chat">
<!--
            <ol class="messages">

                <li class="message--full-right">
                    <img class="message--full-right__avatar" src="/images/profile-bob.jpg" alt="Bob">
                    <div class="message--full-right__container">
                        <div class="message--full-right__container__content">
                            Hello, everyone.
                        </div>
                        <div class="message--full-right__meta">
                            Bob Landon at <time>12:07 PM</time>
                        </div>
                    </div>
                </li>

                <li class="message--full-left">
                    <img class="message--full-left__avatar" src="/images/profile-alice.jpg" alt="Alice">
                    <div class="message--full-left__container">
                        <div class="message--full-left__container__content">
                            Hey there, Bob! How are you doing today?
                        </div>
                        <div class="message--full-left__meta">
                            Alice Smith at <time>12:08 PM</time>
                        </div>
                    </div>
                </li>

                <li class="message--full-right">
                    <img class="message--full-right__avatar" src="/images/profile-bob.jpg" alt="Bob">
                    <div class="message--full-right__container">
                        <div class="message--full-right__container__content">
                            Really well, thanks. How are you, Alice?
                        </div>
                        <div class="message--full-right__meta">
                            Bob Landon at <time>12:09 PM</time>
                        </div>
                    </div>
                </li>

                <li class="message--full-left">
                    <img class="message--full-left__avatar" src="/images/profile-alice.jpg" alt="Alice">
                    <div class="message--full-left__container">
                        <div class="message--full-left__container__content">
                            Very well, thanks.
                        </div>
                        <div class="message--full-left__meta">
                            Alice Smith at <time>12:09 PM</time>
                        </div>
                    </div>
                </li>

                <li class="message--full-left">
                    <img class="message--full-left__avatar" src="/images/profile-alice.jpg" alt="Alice">
                    <div class="message--full-left__container">
                        <div class="message--full-left__container__content">
                            Got a second to help me through some debugging issues?
                        </div>
                        <div class="message--full-left__meta">
                            Alice Smith at <time>12:11 PM</time>
                        </div>
                    </div>
                </li>

                <li class="message--full-right">
                    <img class="message--full-right__avatar" src="/images/profile-bob.jpg" alt="Bob">
                    <div class="message--full-right__container">
                        <div class="message--full-right__container__content">
                            Sure thing. Give me 10 minutes.
                        </div>
                        <div class="message--full-right__meta">
                            Bob Landon at <time>12:12 PM</time>
                        </div>
                    </div>
                </li>

            </ol>
-->
        </section>
    </div>

    <script src="https://cdn.respoke.io/respoke.min.js"></script>
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="http:////cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js"></script>

    <!-- injector:js -->
    <script src="/app/js/app.js"></script>
    <script src="/app/js/lib/helpers.js"></script>
    <script src="/app/js/lib/md5.js"></script>
    <script src="/app/js/lib/tmpl.js"></script>
    <script src="/app/js/models/Client.js"></script>
    <script src="/app/js/models/Endpoint.js"></script>
    <script src="/app/js/models/StatusTypes.js"></script>
    <script src="/app/modules/group-messaging/index.js"></script>
    <script src="/app/modules/group-messaging/state.js"></script>
    <script src="/app/modules/group-messaging/ui.js"></script>
    <!-- endinjector -->

    <script>
        'use strict';

        (function () {

            var $openBtn = $('.group-list-open'),
                $closeBtn = $('.group-list-close');

            function checkStatus () {
                if ($('.group-list').length) {
                    openMenu();
                } else {
                    closeMenu();
                }
            }

            function hideMenu (e) {
                var $openedMenu = $(e.target).closest('.group-list--is-open');

                if ( ($openedMenu.length === 0) && ($(e.target)[0] !== $openBtn[0]) ) {
                    closeMenu();
                }
            }

            function openMenu () {
                $('html, body').animate({
                    scrollTop: 0
                }, 500);
                $('.group-list').removeClass('group-list').addClass('group-list--is-open');
                $('.group-chat').removeClass('group-chat').addClass('group-chat--open-panel');
            }

            function closeMenu () {
                $('.group-list--is-open').removeClass('group-list--is-open').addClass('group-list');
                $('.group-chat--open-panel').addClass('group-chat').removeClass('group-chat--open-panel');
            }

            $openBtn.on('click', checkStatus);
            $closeBtn.on('click', closeMenu);
            $('body').on('click touchstart', hideMenu);

        })();
    </script>
    
    <script type="text/javascript">
        (function () {
            App.state.init('John');
        }());
    </script>
</body>
</html>